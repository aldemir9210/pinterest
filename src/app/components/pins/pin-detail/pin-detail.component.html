<pin-modal title='' klass='pinModal-{{pinIndex}}' size='tiny'>
  <div *ngIf="(pin | async)">
    <h5 href="(pin | async).url">
      {{(pin | async).name}}
    </h5>
    
    <div class="pin-image text-center">
      <img [src]="(pin | async).imagePath" alt="" width="300">
    </div>

    <small>
      {{(pin | async).description}}
    </small>

    <h5>
      From {{(user | async)?.name}}
      <img aria-hidden=true [src]="(user | async)?.avatar" class="avatar"/>
    </h5>

    <form [formGroup]="commentForm" (ngSubmit)="onCommentSave()" *ngIf="userIsAuthenticated | async">
      <div class="input-group">
        <span class="input-group-label comment-user-img">
          <img aria-hidden=true [src]="(authUser | async)?.avatar" class="avatar"/>
        </span>
        <textarea
          type="text"
          id="msg"
          class="input-group-field"
          formControlName="msg">
        </textarea>
        <input type="hidden" formControlName="userId" [ngModel]="(authUser | async).id">
        <input type="hidden" formControlName="pinId" [ngModel]="(pin | async).id">
      </div>
      <div class="row">
        <div class="large-10 large-offset-1">
          <div class="button-group">
            <button type="submit" class="primary button" *ngIf="commentForm.valid">Save</button>
            <a class="warning button" (click)="onCancel()" *ngIf="commentForm.valid">Cancel</a>
          </div>
        </div>
      </div>
    </form>


    <div class="input-group" *ngFor="let comment of comments | async">
      <span class="input-group-label comment-user-img">
        <img aria-hidden=true [src]="(getUser(comment.userId) | async)?.avatar" class="avatar"/>
      </span>
      <i class="text-left">
        {{comment.createdAt | date}}
      </i>
      <div class="input-group-field">
        {{comment.msg}}
        <button
          (click)="onCommentDelete(comment.id)"
          *ngIf="(authUser | async).id == comment.userId">
          <i class="fa fa-times"></i>
        </button>
      </div>
      <br>
    </div>


  </div>

  <div>
    <h4 class="text-center" *ngIf="!(pin | async)">Loading ...</h4>
  </div>
</pin-modal>